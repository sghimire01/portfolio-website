(function($) {
    // Remove no-js class
    $("html").removeClass("no-js");

    // Handle header links
    $("header a").click(function(e) {
        if (!$(this).hasClass("no-scroll")) {
            e.preventDefault();
            var target = $(this).attr("href");
            var scrollToPosition = $(target).offset().top;
            $("html, body").animate({ scrollTop: scrollToPosition + "px" }, Math.abs(window.pageYOffset - $(target).offset().top));
            if ($("header").hasClass("active")) {
                $("header, body").removeClass("active");
            }
        }
    });

    // Handle to-top button
    $("#to-top").click(function() {
        $("html, body").animate({ scrollTop: 0 }, 500);
    });

    // Handle lead-down button
    $("#lead-down span").click(function() {
        var scrollToPosition = $("#lead").next().offset().top;
        $("html, body").animate({ scrollTop: scrollToPosition + "px" }, 500);
    });

    // Experience timeline
    $("#experience-timeline").each(function() {
        var $this = $(this);
        var $userContent = $this.children("div");

        $userContent.each(function() {
            $(this).addClass("vtimeline-content").wrap('<div class="vtimeline-point"><div class="vtimeline-block"></div></div>');
        });

        $this.find(".vtimeline-point").each(function() {
            $(this).prepend('<div class="vtimeline-icon"><i class="fa fa-map-marker"></i></div>');
        });

        $this.find(".vtimeline-content").each(function() {
            var date = $(this).data("date");
            if (date) {
                $(this).parent().prepend('<span class="vtimeline-date">' + date + "</span>");
            }
        });
    });

    // Mobile menu handling
    $("#mobile-menu-open").click(function() {
        $("header, body").addClass("active");
    });

    $("#mobile-menu-close").click(function() {
        $("header, body").removeClass("active");
    });

    // View more projects button
    $("#view-more-projects").click(function(e) {
        e.preventDefault();
        $(this).fadeOut(300, function() {
            $("#more-projects").fadeIn(300);
        });
    });

    // Hide loading screen once page is fully loaded
    $(window).on('load', function() {
        $('#loadingScreen').hide();
    });

    $(window).scroll(function() {
        if ($(this).scrollTop() > 50) {
            $('#navbar').css('background-color', '#000');
        } else {
            $('#navbar').css('background-color', 'transparent');
        }
    });

    $(window).scroll(function() {
        if ($(this).scrollTop() > 50) {
            $('#navbar').addClass('scrolled');
        } else {
            $('#navbar').removeClass('scrolled');
        }
    });
    
    $(window).scroll(function() {
        if ($(this).scrollTop() > 50) {
            $('.navbar').css('background-color', 'rgba(0, 0, 0, 0.8) !important'); // This will add a semi-transparent black background when you scroll down more than 50px
        } else {
            $('.navbar').css('background-color', 'transparent');
        }
    });
    
    

})(jQuery);
